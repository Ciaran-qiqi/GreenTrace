# 优化、问题和开发记录：

1.觉得合约可以随意mint和burn 代币比较不安全，而且先铸造一部分数量存着，最后审计和兑现的时候还要进行一次数量的判断，这样很呆

1.优化：优化了nft销毁时的逻辑，碳币的生成只能依靠nft的兑现，取消销毁逻辑，直接在审计的时候给对应钱包铸造新碳币

2.加入了nft二级交易市场

3.优化了测试逻辑，删去了minter机制，开发环境下采用主合约给业务合约白名单的形式，测试环境下给测试合约权限。

4：初始化逻辑有问题：我先部署nft，nft需要绑定主合约地址，我先部署主合约，主合约也要绑定nft地址  双向绑定了！！

部署到第二步时出现了新的报错：

Error: script failed: Invalid GreenTrace address

问题分析

* 日志显示 CarbonToken 已经部署成功，NFT 合约部署时失败，原因是 Invalid GreenTrace address。
* 这说明在部署 NFT 时，构造函数或初始化参数需要一个有效的 GreenTrace 地址，但传入了无效地址（如 0x0 或未设置）。

可能原因

* 你的 GreenTalesNFT 合约构造函数或初始化逻辑，要求必须传入一个有效的 GreenTrace 地址，不能为 0。
* 但在部署脚本中，NFT 合约是在 GreenTrace 合约部署之前部署的，所以无法传入有效的 GreenTrace 地址。

4：主合约地址有设定nft地址的权限，可以允许一开始是0，所以先部署greentrace，再部署nft，然后再调用主合约的setNFTContract，而token里面没有这种限制，，，然后你去掉了maket的初始化，感觉没什么用；

5然后优化了一下拍卖合约

tender合约逻辑有问题，我是征集人，是出钱的人，我招标人出一个初始的意向金，然后30%的招标押金，和招标完成截至时间，投标人不需要报价，投标人同意，投标人需要给20%的投标押金给合约，然后契约生效，投标人需要在截至时间内完成一个招标人环保项目(链下系统)，截止时间时，双方确认契约是否成功，有一方确认不成功的话，合约结束，一共50%的押金退还给平台，（后续平台链下决定分配和权限），成功的话双方退还押金，招标方把项目金给平台，平台给招标方一个环保故事的nft（后续和拍卖一样可兑换），然后平台扣除手续费2%后给投标项目方

6.加入了事件，后续肯定不可能批量查数组


7.准备把不太清楚的审计拿出主合约

# 后续计划：

1. 审计人员必须有约束，比如质押，审计这部分其实和eth挖矿的逻辑很类似，可以借鉴pos的机制防止审计作恶
2. 目前项目还是面向大众的碳信用自愿市场，后续可以思考如何让企业把他们分配到的碳信用额度融入我们这个体系
3. 可以用碳币发起nft环保小项目，环保人来投标，之后实现一个环保故事，最后生成nft（用碳币买个nft期货，成功后交付nft现货）---代币招标环保故事
4. 也可以是现成的环保故事，环保人发起nft拍卖，拍卖成功铸造nft（把现实项目定价为nft现货）---环保故事招标代币
5. 拍卖和审计部分的合约，是否给链上带来了太多没必要记录的信息？是否信息记录在链下，我的nft信息肯定是链下系统记录的

感觉有问题待解决的部分：
